{
    "cs_auth_schema": {
        "2": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "cs_auth"
                        },
                        "salt": {
                            "type": "string"
                        },
                        "dh_contribution": {
                            "type": "integer"
                        },
                        "iv": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "packet_type",
                        "salt",
                        "dh_contribution",
                        "iv",
                        "tag"
                    ],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "seq": {
                            "type": "integer"
                        },
                        "server_challenge": {
                            "type": "string"
                        },
                        "nonce": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "seq",
                        "server_challenge",
                        "nonce"
                    ],
                    "additionalProperties": false
                }
            },
            "required": [
                "metadata",
                "payload"
            ],
            "additionalProperties": false
        },
        "4": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "cs_auth"
                        },
                        "iv": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "packet_type",
                        "iv",
                        "tag"
                    ],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "seq": {
                            "type": "integer"
                        },
                        "client_challenge_solution": {
                            "type": "integer"
                        }
                    },
                    "required": [
                        "seq",
                        "client_challenge_solution"
                    ],
                    "additionalProperties": false
                }
            },
            "required": [
                "metadata",
                "payload"
            ],
            "additionalProperties": false
        }     
    },
    "list_schema": {
        "2": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "list"
                        },
                        "iv": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "packet_type",
                        "iv",
                        "tag"
                    ],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "seq": {
                            "type": "integer"
                        },
                        "nonce": {
                            "type": "string"
                        },
                        "signed_in_users": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            }
                        }
                    },
                    "required": [
                        "seq",
                        "nonce",
                        "signed_in_users"
                    ],
                    "additionalProperties": false
                }
            },
            "required": [
                "metadata",
                "payload"
            ],
            "additionalProperties": false
        }
    },
    "message_schema": {
        "2": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "message"
                        },
                        "iv": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "packet_type",
                        "iv",
                        "tag"
                    ],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "seq": {
                            "type": "integer"
                        },
                        "nonce": {
                            "type": "string"
                        },
                        "recipient": {
                            "type": "string"
                        },
                        "encryption_public_key": {
                            "type": "string"
                        },
                        "signature_verification_public_key": {
                            "type": "string"
                        },
                        "listen_address": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "seq",
                        "nonce",
                        "recipient",
                        "encryption_public_key",
                        "signature_verification_public_key",
                        "listen_address"
                    ],
                    "additionalProperties": false
                }
            },
            "required": [
                "metadata",
                "payload"
            ],
            "additionalProperties": false
        }
    },
    "logout_schema": {
        "2": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "logout"
                        },
                        "iv": {
                            "type": "string"
                        },
                        "tag": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "packet_type",
                        "iv",
                        "tag"
                    ],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "seq": {
                            "type": "integer"
                        },
                        "nonce": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "seq",
                        "nonce"
                    ],
                    "additionalProperties": false
                }
            },
            "required": [
                "metadata",
                "payload"
            ],
            "additionalProperties": false
        }
    },
    "errors_schema": {
        "pre_auth": {
            "type": "object",
            "properties": {
                "metadata": {
                    "type": "object",
                    "properties": {
                        "packet_type": {
                            "type": "string",
                            "const": "error"
                        },
                        "state": {
                            "type": "string",
                            "enum": ["pre_auth", "post_auth"]
                        },
                        "error_count": {
                            "type": "integer",
                            "minimum": 0
                        }
                    },
                    "required": ["packet_type", "state"],
                    "additionalProperties": false
                },
                "payload": {
                    "type": "object",
                    "properties": {
                        "message": {
                            "type": "string"
                        },
                        "nonce": {
                            "type": "string"
                        },
                        "signature": {
                            "type": "string"
                        }
                    },
                    "required": ["message", "signature"],
                    "additionalProperties": false
                }
            },
            "required": ["metadata", "payload"],
            "additionalProperties": false
        }
    }
}
